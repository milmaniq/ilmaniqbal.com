<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Learn how to dockerize a Spring Boot application backed by a MySQL database. Explore Docker, Docker Compose, and container orchestration tools like Docker Swarm and Kubernetes.">
    <meta name="keywords"
        content="Docker, Spring Boot, MySQL, Dockerize Spring Boot, Docker Compose, Kubernetes, Docker Swarm, container orchestration">
    <meta name="author" content="Ilman Iqbal">
    <title>Dockerizing a Spring Boot Application Backed by a MySQL Database</title>
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Article",
            "headline": "Dockerizing a Spring Boot Application Backed by a MySQL Database",
            "author": {
                "@type": "Person",
                "name": "Ilman Iqbal",
                "url": "https://www.linkedin.com/in/ilman-iqbal-096308172"
            },
            "publisher": {
                "@type": "Organization",
                "name": "Ilman Iqbal",
                "url": "https://ilmaniqbal.com",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://ilmaniqbal.com/img/logo.png"
                }
            },
            "datePublished": "2024-01-24",
            "dateModified": "2025-09-28",
            "image": "https://ilmaniqbal.com/img/docker-1.png",
            "description": "Step-by-step guide to dockerize a Spring Boot application backed by MySQL. Learn how to build Docker images, use Docker Compose for multi-container setups, and manage containers with Docker Swarm or Kubernetes for scalable deployment.",
            "articleBody": "This article explains how to dockerize a Spring Boot customer-service application backed by a MySQL database. It covers creating Docker images using Dockerfiles, managing multi-container applications with Docker Compose, and orchestrating containers with Docker Swarm or Kubernetes. Key steps include setting up environment variables, using volumes for persistent data, exposing ports, and connecting containers via Docker networks. Additionally, it covers pushing images to Docker Hub, running containers locally, and handling common use cases such as connecting a Spring Boot container to a MySQL container or a local database instance.",
            "keywords": "Docker, Spring Boot, MySQL, Dockerize Spring Boot, Docker Compose, Kubernetes, Docker Swarm, container orchestration",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://ilmaniqbal.com/dockerize-spring-boot-mysql-application.html"
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <!-- https://fontawesome.com/ -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap" rel="stylesheet">
    <!-- https://fonts.google.com/ -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/blog.css" rel="stylesheet">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8PPCHX9PDV"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-8PPCHX9PDV');
    </script>
</head>

<body>
    <div class="container">
        <header class="site-header">
            <a href="index.html" class="site-logo-wrapper" style="text-decoration: none; color: inherit;">
                <div class="site-logo"><i class="fas fa-code fa-2x"></i></div>
                <h1>Ilman Iqbal's Blog</h1>
            </a>
        </header>
        <main>
            <article>
                <h2 class="tm-post-title">Dockerizing a Spring Boot application backed
                    by a MySQL Database</h2>
                <p class="meta">Jan 24, 2024 posted by Ilman Iqbal</p>

                <p>This article explains on how a customer-service Spring Boot application that is backed by
                    a MySQL database
                    can be dockerized.</p>

                <img id="half-width" src="img/docker-1.png" alt="dockerize-spring-boot-mysql-application" />

                <p>
                    Docker is a tool designed to make it easier to create, deploy, and run applications by
                    using containers.
                </p>
                <p>
                    Docker Compose can be used to define and manage multi-container Docker applications.
                    Docker Swarm and Kubernetes are popular for orchestrating multiple containers, scaling
                    them, managing their lifecycle, and ensuring high availability.
                </p>
                <p>
                    With docker, You can create an image of your application, push it to a Docker registry
                    (like Docker Hub), and then pull that image onto any environment where Docker is
                    installed, ensuring your application runs in the same way everywhere.
                </p>
                <p>
                    To create a docker image, you must create a dockerfile. You'd define a Dockerfile, which
                    contains instructions on how to build your Java Spring application's container image.
                    This might involve specifying a base image (like one with Java already installed),
                    copying your application code, installing dependencies, and exposing necessary ports.
                </p>
                <p>An advanced docker file is given below:</p>

                <pre>
# Use a base image with Java pre-installed
FROM openjdk:11-jre-slim

# Set maintainer information
LABEL maintainer="app_creator@example.com"

# set environment variables that can be overridden during container creation if needed. DB_PASSWORD=$DB_USERNAMEchangeit means 'changeit' is appendeded to the existing value of $DB_USERNAME
ENV DB_USERNAME=mysql-service
ENV DB_USERNAME=root
ENV DB_PASSWORD=$DB_USERNAMEchangeit

# create a directory named logs inside the root directory of the container
RUN mkdir -p /logs

# Set the working directory inside the container. This is where subsequent commands will be executed unless they start with root path.
WORKDIR /app

# Copy customer-service spring application JAR to the container as customer-service-app jar
COPY target/customer-service.jar ./customer-service-app.jar

# specify directory within the container for persisting or sharing data, but this data will be lost when the container gets deleted
VOLUME /logs

# expose port 8080 from the Docker container
EXPOSE 8080

# Define the command to run the application. 
# the following line is same as 'CMD java -jar /app/customer-service-app.jar' or CMD ["java", "-jar", "/app/customer-service-app.jar"]
# as WORKDIR is specified above, this command will launch the customer-service-app.jar file within the /app directory.
CMD ["java", "-jar", "./customer-service-app.jar"]
                </pre>

                <h4>
                    CMD vs ENTRYPOINT in dockerfile?
                </h4>

                <p>CMD sets default command and/or parameters which can be overridden during container
                    runtime.
                    i.e. When starting a container, if a command is specified along with the docker run
                    command, it overrides the command specified in the CMD instruction.

                    ENTRYPOINT defines the command and parameters that cannot be overridden during container
                    runtime.
                    i.e. When starting a container, if arguments are provided with docker run, they are
                    appended to the command specified by ENTRYPOINT.</p>

                <h4>
                    COPY vs ADD in dockerfile?
                </h4>

                <p>COPY command copies files from the source on the host to a destination in the container.

                    ADD command not only copies files but can also do things like extract compressed
                    archives (e.g., .tar, .tar.gz, .zip) and retrieve files from URLs.</p>

                <h4>
                    WORKINGDIR in dockerfile?
                </h4>

                <p>It defines the default directory for any subsequent RUN, CMD, ENTRYPOINT, COPY, and ADD
                    commands within the Dockerfile.
                    This means you don't need to specify absolute paths for files and directories; commands
                    will execute within this directory unless otherwise specified.
                </p>

                <h4>
                    How to build a docker image from a spring boot project?
                </h4>
                <ol>
                    <li>Define the dockerfile</li>
                    <li>Execute <code>mvn clean package</code> in project root</li>
                    <li>Execute <code>docker build -t customer-service[:tag] .</code> in project root.
                        (<code>.</code> specifies the build context, indicating that the Dockerfile is
                        in the current directory)
                    </li>
                </ol>
                <h4>
                    How to push a docker image to docker hub?
                </h4>
                <ol>
                    <li>Login to Docker Hub:

                        <pre>
> docker login
Username: milmaniq
Password: {enter your password here}
Login Succeeded
                        </pre>
                    </li>

                    <li>
                        Tag the local docker image with a repository in the docker registry:
                        <pre>
> docker tag customer-service:latest milmaniq/customer-service:1.0
                        </pre>
                    </li>

                    <li>
                        Push the image to docker hub:
                        <pre>
> docker push milmaniq/customer-service:1.0
                         </pre>
                    </li>

                    <p>The docker image will be published in docker hub at the following link:
                    <pre>
https://hub.docker.com/repository/docker/{your-docker-username}/customer-service/general
                        </pre>

                    </p>

                </ol>
                <h4>
                    How to pull an image from docker hub and run it?
                </h4>
                <ol>
                    <li>Pull the image from docker hub (if it is not locally available) and run it:

                        <pre>
> docker run -p 5000:8000 milmaniq/customer-service:1.0
                        </pre>

                        <p>
                            You can override the value of <code>DB_USERNAME</code> in Dockerfile or
                            application.properties file when creating a container from this image:
                        <pre>
> docker run -e DB_USERNAME=new_username customer-service:1.0
                            </pre>
                        </p>
                    </li>
                </ol>
                <h4>
                    Other useful commands in docker
                </h4>
                <div>
                    <pre>
# to view the list of docker images in the local system:
> docker image ls

# to delete a docker images in the local system:
> docker image rm postgres:13-beta2-alpine

# to pull a docker image from docker hub:
> docker pull mysql[:tag]

# to find out the ports exposed by a docker image:
> docker inspect mysql:latest
# or to get specific results, you can use the following command
> docker inspect --format='{{.Config.ExposedPorts}}' redis:latest

# to run the docker image in a docker container. (if the docker image is not available loccally, then it will be downloaded automatically from docker hub)
> docker run -d -p 5000:8080 spring-demo-project
# -d -> to run the container in detached mode
# -p -> specifies that the port 8080 on the container must be mapped to port 5000 in the host OS
# you can access the endpoints in the spring-demo project usng base url as http://localhost:5000

# to view the list of all the running containers:
> docker container ls 
# or
> docker ps

# to find out the IP address of the container, (so that this container can communicate with another container:
> docker inspect {container-id}

# to restart a docker container:
> docker restart {container-id}

# to stop a docker container:
> docker stop {container-id}

# to log into the docker container
> docker exec -it {container-id} bash
                    </pre>
                </div>
                <h4>
                    How to run a MySQL container in windows?
                </h4>
                <ol>
                    <li>Download docker desktop and install it</li>

                    <li>Open docker desktop</li>

                    <li>
                        Pull the latest docker image to your local machine:
                        <pre>
> docker pull mysql

# If you want to download a specific version, then you have to specify the tag as shown in the following command. these tags can be viewed in the tag tab of the selected docker image in the docker hub online
> docker pull mysql:8.0.33
                         </pre>
                    </li>

                    <li>
                        Create a container from the downloaded docker image:
                        <pre>
> docker run mysql
# When you run the above command, you will get an error message to set environment variables. So you will have to run the mysql docker container as shown below:

> docker run -d --name mysql8db -e MYSQL_ROOT_PASSWORD=123456 -p 3307:3306 -p 33070:33060 -v mysql8db_data:/var/lib/mysql mysql
# -e -> is used to set environment variables
# -d -> is used to run the container in a detached mode
                         </pre>
                    </li>

                </ol>
                <h4>
                    How can you retain the data that is persisted to the container volume?
                </h4>
                <p>
                    When you run a container from an image created with this Dockerfile, you can use the
                    <code>--volume</code> or <code>-v</code> flag to get the container volume directory
                    mapped to a:
                </p>
                <ol>
                    <li>Named Volume
                        <pre>
> docker run -v mysql_data:/var/lib/mysql
# The container volume directory will be managed by the Docker's volume system. To manage volumes or view their details, you can use Docker commands like docker volume ls, docker volume inspect, and docker volume rm.
                        </pre>
                    </li>

                    <li>Bind Mount
                        <pre>
> docker run -v C:/Users/Me/local_logs:/logs
# The local directory local_logs will be mounted to the container's /logs directory
                        </pre>

                    </li>
                </ol>

                <h4>
                    Some usecases when working with a MySQL backed Spring Boot application in Docker
                </h4>
                <p>
                    Imagine, you have a customer-service container and a mysql container. Both of these
                    containers are running individually. How to make the customer-service container to
                    connect to the MySQL container?
                </p>
                <ol>
                    <li>
                        Ensure that you have the spring.datasource.url of customer-service in the following
                        format:
                        <pre>
spring.datasource.url=jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:1234}/customer_service_db?createDatabaseIfNotExist=true
                        </pre>
                    </li>

                    <li>
                        Create a new docker network:
                        <pre>
> docker network create springboot-mysql-net
                        </pre>
                    </li>

                    <li>
                        Run MySQL container in a network:
                        <pre>
> docker run --name mysqldb --network springboot-mysql-net -e MYSQL_ROOT_PASSWORD=123456 -e MYSQL_DATABASE=customer_service_db -p 3309:3306 -p 33090:33060 -d mysql
# It is important to provide a name for the container
                        </pre>
                    </li>

                    <li>
                        Run the customer-service container in the same network:
                        <pre>
> docker run --network springboot-mysql-net -p 8080:8080 -e DB_HOST=mysqldb -e DB_PORT=3306 customer-service
# You must pass the host and the container name, and the port as the internal port of the container
                        </pre>
                    </li>
                </ol>

                <p>
                    Imagine, you want to connect a customer-service container to a local mysql instance that
                    is running on port 3307, (or a mysql docker instance that is exposed from port 3307) How
                    to do this?
                </p>
                <ol>
                    <li>
                        Define the spring.datasource.url property in the customer-service project:
                        <pre>
spring.datasource.url=jdbc:mysql://${DB_HOST:127.0.0.1}:${DB_PORT:3307}/${DB_NAME:customer_service_db}?createDatabaseIfNotExist=true
                        </pre>
                    </li>

                    <li>
                        Build the docker image. Run the docker image using the following command:
                        <pre>
> docker run --name customer-service -p 8080:8080 -v "C:/Ilman/Projects/customer-service/logs":/app/logs -e DB_HOST=host.docker.internal  customer-service
# It is important to specify the DB_HOST as 'host.docker.internal'. The volume is enclosed in double quotes because of a hyphen in the path. It wont work with single quotes
                        </pre>
                    </li>
                </ol>
                <p>
                    When you want to communicate between a customer-service container and a mysql container,
                    it is recommended to use the docker networking method given above.
                    But, it is also possible to connect to the mysql docker from the customer-service docker
                    by running the container with this argument <code>-e DB_HOST=host.docker.internal</code>
                </p>

                <p>
                    Imagine, you want to connect a customer-service (that is started from a JAR file) to a
                    local mysql instance that is running on port 3307. How to do this?
                </p>
                <ol>
                    <li>
                        Define the spring.datasource.url property in the customer-service project as
                        follows:
                        <pre>
spring.datasource.url=jdbc:mysql://127.0.0.1:3307/customer_service_db?createDatabaseIfNotExist=true
                        </pre>
                    </li>

                    <li>
                        Compile the app:
                        <pre>
> mvn clean package -DskipTests
                        </pre>
                    </li>

                    <li>
                        Run the app:
                        <pre>
> java -jar .\target\customer-service-0.0.1-SNAPSHOT.jar
                        </pre>
                    </li>
                </ol>

            </article>

            <footer>
                <hr>
            </footer>
        </main>
    </div>
</body>

</html>